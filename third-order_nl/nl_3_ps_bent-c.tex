\documentclass{article}
\usepackage{fullpage,enumitem,amsthm,amsmath,amssymb,graphicx,empheq,bm}
\usepackage{physics}
\usepackage{tcolorbox}
\usepackage[citecolor=blue]{hyperref}
\usepackage{tikz}
\usepackage[noadjust]{cite}
\usepackage{multirow}
\usepackage{threeparttable}


\newcommand{\Z}{\mathbf{Z}}
\newcommand{\F}{\mathbb{F}}
\newcommand{\Com}{\mathbf{C}}
\newcommand{\ord}{\operatorname{ord}}
\newcommand{\Q}{\mathbf{Q}}
\newcommand{\R}{\mathbf{R}}
\newcommand{\E}{\mathbb{E}}
\newcommand{\0}{\textbf{0}}
\newcommand{\1}{\textbf{1}}
\newcommand{\wt}{\operatorname{wt}}
\newcommand{\B}{\mathcal{B}}
\newcommand{\nl}{\mathrm{nl}}
\newcommand{\TRACE}{\operatorname{Tr}_1^k}
\newcommand{\TrN}{\operatorname{Tr}_1^n}
\theoremstyle{plain}

\newtheorem{lemma}{Lemma}
\newtheorem{theorem}{Theorem}
\newtheorem{remark}{Remark}
\newtheorem{corollary}{Corollary}
\newtheorem{definition}{Definition}
% \theoremstyle{nonumberplain}



\newtheorem{construction}{Construction}
% \newcommand{\Tr}{\mathrm{Tr}_1^n}
% \newcommand{\tr}{\mathrm{Tr}_1^k}

\title{A lower bound on the third-order of simplest $\mathcal{PS}_{ap}$ bent function}




\begin{document}
%   \maketitle
  \noindent
  \rule{\linewidth}{0.4pt}

\begin{abstract}
    The $r$-th order nonlinearity of a Boolean function is an important cryptographic criterion, quantifying the resistance to some well-known cryptanalysis such as nonlinear approximation attacks in block ciphers. 
    It also plays a role in coding theory and theoretical computer science, since it relates to the covering radius of Reed-Muller codes and Gowers norm. 
    In this paper, we provide a lower bound on the third-order nonlinearity of the $n$-variable simplest $\mathcal{PS}_{ap}$ bent function, where $n\ge 6$ is even, by calculating the nonlinearities of all second-order derivatives of the function. 
    The result shows that our lower bound is always tighter than previously known lower bounds.
\end{abstract}
    
\section{Introduction}
    Boolean functions play an important role in the design of symmetric cryptography, coding theory and theoretical computer science, see \cite{Carlet2020book,BhattacharyyaKSSZ2010gowers,CohenHLL1997RMcodecover}.
    The $r$-th order nonlinearity of Boolean functions is of great interest, for being the most important cryptographic criteria for symmetric cryptography \cite{Carlet2020book}.
    This cryptographic criterion, denoted by $nl_r(f)$, measures the minimum Hamming distance of a Boolean function $f$ in $n$ variables to the set of all functions in $n$ variables of algebraic degree at most $r\le n$, where $r$ is a positive number.
    The Boolean functions used in symmetric cryptography must have high $r$-th order nonlinearity for being against attacks illustrated in several papers \cite{Golic1996lower_order_approximation,IwataK1999highorderbentfunction,KnudsenR1996nonlinear_approximation,Courtois2002XL_algorithm_and_NL_r}.
    In coding theory, $nl_r(f)$ equals the distance from $f$ to the Reed-Muller code $\mathcal{RM}(r,n)$ of length $2^n$ and of order $r$.
    Thus, the maximum $r$-th order nonlinearity of all Boolean functions in $n$ variables equals the covering radius of $\mathcal{RM}(r,n)$ \cite{CohenHLL1997RMcodecover}.
    This cryptographic parameter is also related to the Gowers norm in theoretical computer science, since the correlation between a Boolean function $f$ to the closest polynomial of degree $d$ is at most its $(d+1)$-th Gowers norm \cite{BhattacharyyaKSSZ2010gowers}.

    % Computing algorithmically the $r$-th order nonlinearity of an $n$-variable Boolean function is hard for $r>1$.
    However, it is a hard task to compute theoretically and algorithmically the $r$-th order nonlinearity of a Boolean function with algebraic degree strictly greater than $r$ for $r>1$.
    Even for $r=2$, there exist only a few functions in special forms and functions with small number of variables such that the second-order nonlinearity can be fully determined.
    With regards to computing algorithmically, the first-order nonlinearity is related with the Walsh transform, which can be easily computed by an algorithm.
    As for the second-order nonlinearity of Boolean functions, Kabatiansky and Tavernier \cite{KabatianskyT2005listdecoding_RM_2_n} proposed a nice algorithm by using list decoding of second-order Reed-Muller codes to calculate it.
    Soon, this algorithm was improved and implemented to quadratic Boolean functions up to $n=11$ and up to $n=13$ in some special cases \cite{FourquetT2008improved_listdecoding_RM_2_n}. 
    It can also be applied to higher order nonlinearity but for small numbers of variables. 
    Very little is known for algorithms related with $r$-th order nonlinearity for $r>1$. 

    It is, therefore, important that proving lower bounds on the $r$-th order nonlinearity of Boolean functions. 
    However, it is still a difficult task, even for $r=2$. 
    In \cite{Carlet2008lowbound_NL_profile}, Carlet gave two lemmas about lower bounds on the $r$-th order nonlinearity of a Boolean function.
    Meanwhile, he derived some lower bounds on the $r$-th order nonlinearity of Maiorana-McFarland, Welch, Kasami and inverse functions.
    Owing to Carlet's lemmas for efficiently lower bounding the $r$-th order nonlinearity, numerous authors have obtained lower bounds on the $r$-th order nonlinearity of different functions, mostly for $r=2,3$ \cite{YanT2020NL_2,Liu2023NL_2,TangYZZ2020NL_2bent,SihemKJ2020NL_2cubic,SunW2009NL_2,SarkarG2009NL_2MM,GangopadhyayST2010NL_2,GodeG2010NL_3Kasami,SunW2011NL_2,TangCT2013NL_2bent,Singh2014NL_3_biquadratic,GaoT2017NL_2_MM}.
    
    Bent functions, which achieve maximum possible first-order nonlinearity, 
    have attracted a lot of research due to their applications in cryptography and relations to mathematical objects \cite{Carlet2020book}. 
    As a consequence, we focus on the property of the higher order nonlinearity of a class of bent functions. 
    More specifically, in this paper, we derive a lower bound on the third-order nonlinearity of the simplest $\mathcal{PS}_{ap}$ bent function (where $ap$ indicates ``affine plane'').  
    Note that all elements possess explicit mathematical expressions in the $\mathcal{PS}_{ap}$ class, which is a subclass of the $\mathcal{PS}$ class, one of the most well-known bent function classes based on a partial spread proposed by Dillon. 
    The explicit and simplest expressions of bent functions will guarantee the low complexity and high feasibility of the proof, that is another reason why we concentrate on them. 
    % All elements of the $\mathcal{PS}_{ap}$ class have explicit representations, compared with other elements of the $\mathcal{PS}$ class. 
    % The full classification of bent functions seems hopeless, 
    % There are many special constructions and one of the most well-known constructions based on a partial spread ($\mathcal{PS}$ for short) is proposed by Dillon in \cite{Dillon1974PSbent}.
    % We always call this class of bent functions the $\mathcal{PS}$ class.
    % The $\mathcal{PS}$ class can be divided into two subclasses called $\mathcal{PS}^-$ and $\mathcal{PS}^+$. 
    % , whose cardinalities of supports are different.
    % While the algebraic representations of bent functions in the $\mathcal{PS}$ class seem to be difficult to derive, Dillon exhibited a subclass of the $\mathcal{PS}^-$ class, denoted by $\mathcal{PS}_{ap}$ (where $ap$ indicates ``affine plane''), whose elements possess explicit representations.
    % Deriving a lower bound on the third-order nonlinearity of functions in the $\mathcal{PS}_{ap}$ class is the main issue in this paper and we will discuss it in section $3$ in detail.

    In this paper, we aim to derive a lower bound on the third-order nonlinearity of the simplest $\mathcal{PS}_{ap}$ bent function $f(x,y)$.
    To this end, we only need to determine the nonlinearities of the second-order derivatives of $f(x,y)$ for all possible pairs $(\alpha,\beta)$, according to Carlet's lemma.
    As for the nonlinearity of $D_{\beta}D_{\alpha}f(x,y)$ with the case $(\alpha,\beta)\in\F_{2^k}^2$, the calculation of its Walsh spectrum indicates that it is equivalent to determine the maximal absolute values of the special character sums with $(\mu,\nu)$ ranging over $\F_{2^k}^2$.
    By simple algebraic geometry lemmas and the calculation, a lower bound on the nonlinearities of $D_{\beta}D_{\alpha}f(x,y)$ for all trivial pairs $(\alpha,\beta)$ is derived.
    While for the general pairs $(\alpha,\beta)$, we obtain the corresponding nonlinearities by determining the number of solutions for systems of trace functions.
    We derive then a lower bound on the third-order nonlinearity of the simplest $\mathcal{PS}_{ap}$ bent function.

    In the present paper, 
    % we derive a lower bound on the third-order nonlinearity of the simplest $\mathcal{PS}_{ap}$ bent function.
    we improve the previous lower bounds in \cite{TangCT2013NL_2bent,Carlet2011NL_Profile_Dillon}, and the comparison of three lower bounds can be found in Table \ref{table:MyTableLabel} for small concrete values.
    Specifically, our lower bound is asymptotically equivalent to $2^{n-1}-2^{\frac{7n}{8}-\frac{1}{2}}$, whose
    % comparing with the best known lower bound, Carlet bound in \cite{Carlet2011NL_Profile_Dillon},
    improvement is approximate $(\sqrt{2}-1)2^{\frac{7n}{8}-\frac{1}{2}}$, compared with Carlet's lower bound.
    Additionally, our lower bound is much more efficient than the two previous lower bounds when $n\le 18$ as we have showed.
    
    The remainder of this paper is organized as follows.
    Section 2 introduces some basic notions which will be used in this paper.
    In Section 3, we begin with some lemmas, which are useful for proving our main result, and then we derive a lower bound on the third-order nonlinearity of the simplest $\mathcal{PS}_{ap}$ bent function.
    Finally, Section 4 is a conclusion.
    % Throughout this work, for the integer $n$, denote $|n|$ the absolute value of $n$.
    
\section{Preliminaries}
    Let $\F_2$ be the field with two elements $\{0,1\}$ and $\F_2^n$ be the vector space of $n$-tuples over $\F_2$.
    Let $\F_{2^n}$ be the finite field of order $2^n$.
    The Hamming weight of the vector $a=(a_1,a_2,\dots,a_n)\in\F_2^n$ is defined as $\wt(a)=\#\left\{ 1\le i\le n\mid a_i\ne 0 \right\}$, where $\#S$ denotes the cardinality of a given set $S$.
    For any integer $0\le i \le 2^n-1$, we denote by $\overline{i}=(i_1,i_2,\dots,i_n)\in\F_2^n$ the binary expansion of $i$, \emph{i.e.}, $i=\sum_{j=0}^{n-1}i_{j+1}2^j$.
    In the rest of this paper, we use $+$ (resp. $\Sigma$) to denote the addition (resp. multiple sums) in  the set of integers $\Z$ or finite field $\F_{2^n}$, and use $\oplus$ (resp. $\bigoplus$) to denote the addition (resp. multiple sums) in $\F_2$ or $\F_2^n$.
    If the context is clear, we shall use $+$ (resp. $\Sigma$) to replace $\oplus$ (resp. $\bigoplus$).
    The Hamming distance between two vectors $a=(a_1,a_2,\dots,a_n),b=(b_1,b_2,\dots,b_n)\in\F_2^n$ is defined as $d_H(a,b)=\#\left\{ 1\le i\le n\middle| a_i\ne b_i \right\}$, and it can be easily checked that $d_H(a,b)=\wt(a\oplus b)$.

    A Boolean function of $n$ variables is a mapping from $\F_2^n$ to $\F_2$.
    The set of all $n$-variables Boolean functions from $\F_2^n$ to $\F_2$ is denoted by $\mathcal{B}_n$.
    The most well-known representation of an $n$-variable Boolean function $f$ is by its truth table (in brief, TT), \emph{i.e.},
    \[f=\left[ f(0,0,\dots,0),f(1,0,\dots,0),\dots,f(0,1,\dots,1),f(1,1,\dots,1) \right].\]
    Clearly, this representation is unique.
    The support of $f$, denoted by $\operatorname{supp}(f)$, is defined as the set $\left\{ x\in\F_2^n\middle|f(x)\ne 0 \right\}$.
    The Hamming weight of $f$, denoted by $\wt(f)$, is defined as the cardinality of the support of $f$.
    It is well-known that any $f\in\mathcal{B}_n$ in variables $x_1,x_2,\dots,x_n$ can also be represented by its algebraic normal form (in brief, ANF)
    \[f(x_1,x_2,\dots,x_n) = \bigoplus_{u\in\F_2^n}a_ux^u,\]
    where $x=(x_1,x_2,\dots,x_n)\in\F_2^n$, $a_u\in\F_2$ and the term $x^{u}=\prod_{i=1}^nx_i^{u_i}$ is called a monomial.
    The algebraic degree of $f$ is then denoted by $\deg(f)=\max\left\{ \wt(u)\middle| u\in\F_2^n, a_u\ne 0 \right\}$.
    If a Boolean function has algebraic degree at most $1$, we say that it is an affine function.
    The set of all affine functions is denoted by $A_n$.
    And we shall call quadratic functions the Boolean functions of algebraic degree at most $2$.
    It is known that the vector space $\F_2^n$ is isomorphic to the finite field $\F_{2^n}$ through a choice of a basis of $\F_{2^n}$ over $\F_2$.
    Indeed, if $(\lambda_1,\lambda_2,\dots,\lambda_n)$ is a basis of $\F_{2^n}$ over $\F_2$, then every vector $x=(x_1,x_2,\dots,x_n)\in\F_2^n$ can be
    identified with the element $x_1\lambda_1+x_2\lambda_2+\cdots+x_n\lambda_n\in\F_{2^n}$ and thus $\F_{2^n}$ can be viewed as an $n$-dimensional vector space over $\F_2$.
    Therefore, any $n$-variable Boolean function can also be defined over $\F_{2^n}$ and uniquely represented by a univariate polynomial in variable $x$ over $\F_{2^n}$
    \[f(x) = \sum_{i=0}^{2^n-1}\sigma_ix^i,\]
    where $\sigma_0,\sigma_{2^n-1}\in\F_2$ and for every $i\in\{1,2,\dots,2^n-2\}$, $\sigma_{2i\pmod{2^n-1}}=\sigma_i^2$.
    In this case, the algebraic degree of $f$ can be computed by $\max\left\{ \wt(\overline{i})\mid \sigma_i\ne 0, 0\le i\le 2^n-1 \right\}$ and the set $A_n$ is constituted by the functions $\Tr_1^n(\alpha x)\oplus c$, where $\alpha\in\F_{2^n}, c\in\F_2$ and $ \Tr_m^n(x)=x+x^{2^m}+x^{2^{2m}}+\cdots+x^{2^{n-m}}$ is the (absolute) trace function from $\F_{2^n}$ to $\F_{2^m}$ with $m\mid n$.
    Particularly, when $n$ is even, any $n$-variable Boolean function $f$ can be uniquely expressed by a bivariate polynomial in variables $x,y\in\F_{2^{n/2}}$ over $\F_{2^{n/2}}$
    \[f(x,y)=\sum_{0\le i,j\le 2^{n/2}-1}f_{i,j}x^iy^j,\]
    where $f_{i,j}$'s are elements in the finite field $\F_{2^{n/2}}$.
    In this case, the algebraic degree of $f$ can be computed by $\max\left\{ \wt(\overline{i})+\wt(\overline{j})\mid f_{i,j}\ne 0, 0\le i,j\le 2^{n/2}-1 \right\}$ and the set $A_n$ is constituted by the function $\Tr_1^{n/2}(\alpha x+\beta y)\oplus c$, where $\alpha,\beta\in\F_{2^{n/2}}$ and $c\in\F_2$.

    In coding theory, a binary linear code $\mathcal{C}$ with length $N$ is a subspace of $\F_2^N$ and $\F_2$-dimension of this subspace is called the dimension of $\mathcal{C}$.
    The minimum distance of $\mathcal{C}$ is defined as the minimum Hamming weight of all nonzero vectors (called codewords in the coding theory).
    A binary linear code has length $N$, dimension $k$ and minimum distance $d$ is called an $\left[ N,k,d \right]$-code.
    The Reed-Muller code of order $r$, denoted by $\mathcal{RM}(r,n)$, where $1\le r\le n$, is formed by the truth tables of all $n$-variable Boolean functions with algebraic degree at most $r$.  The covering radius of a binary $\left[ N,k,d \right]$-code is defined as the smallest integer $\rho$ such that all
    vectors in $\F_2^N$ are within Hamming distance $\rho$  of some codewords (see more details in \cite{MS1977}).
    Thus, the maximum $r$-th order nonlinearity of all Boolean functions in $n$ variables equals the covering radius of $\mathcal{RM}(r,n)$, \emph{i.e.},
    \[\max_{f\in \mathcal{B}_n}nl_r(f)=\max_{f\in\mathcal{B}_n}d_H(f,\mathcal{RM}(r,n)).\]

    \begin{definition}
        The $r$-th order nonlinearity of a Boolean function $f\in\mathcal{B}_n$ is defined as its minimum Hamming distance from $f$ to all the $n$-variable Boolean functions with degree at most $r$
        \[nl_r(f)=\min_{g\in\mathcal{B}_n,\deg(g)\le r} d_H(f,g),\]
        where $d_H(f,g)$ denotes the Hamming distance between $f$ and $g$,\emph{i.e.}, $d_H(f,g)=\#\left\{ x\in\F_2^n\middle|f(x)\ne g(x) \right\}$.
    \end{definition}
    The first-order nonlinearity of $f$ is simply called the nonlinearity of $f$ and is denoted by $nl(f)$.
    The nonlinearity $nl(f)$ is the minimum Hamming distance between $f$ and all the affine functions.
    In order to be resistant against the best affine approximation \cite{DingXS1991book} and the fast correlation attack \cite{MS1988fast_correlation_attack}, Boolean functions used in cryptosystems must have high nonlinearity.
    It should be noted that the maximal $r$-th order nonlinearity of all Boolean functions in $n$ variables is equal to the covering radius of $\mathcal{RM}(r, n)$ (see more details in \cite{CohenHLL1997RMcodecover}).

    The nonlinearity of any Boolean function can also be expressed by means of its Walsh transform.
    Let $x=(x_1,x_2,\dots,x_n)$ and $a=(a_1,a_2,\dots,a_n)$ be two vectors in $\F_2^n$ and $a\cdot x=a_1x_1\oplus a_2x_2\oplus\cdots\oplus a_nx_n$ be the usual inner product in $\F_2^n$.
    The Walsh transform of any $n$-variable Boolean function $f$ at a point $a\in\F_2^n$ is defined as
    \[W_f(a)=\sum_{x\in\F_2^n}(-1)^{f(x)+a\cdot x}.\]
    The multiset formed by the values of the Walsh transform is called the Walsh spectrum of $f$.
    If $f$ is defined over $\F_{2^n}$, the Walsh transform of $f$ at a point $\alpha\in\F_{2^n}$ is defined as
    \[W_f(\alpha)=\sum_{x\in\F_{2^n}}(-1)^{f(x)+\TrN(\alpha x)}.\]
    In addition, if $n=2k$ is even and $f(x,y)$ is the bivariate polynomial form of $f$, the Walsh transform of $f$ at $(\alpha,\beta)\in\F_{2^k}^2$ is defined as
    \[W_f(\alpha,\beta)=\sum_{(\alpha,\beta)\in\F_{2^k}^2}(-1)^{f(x,y)+\Tr_1^k(\alpha x+\beta y)}.\]
    Observing the Walsh transform, we can easily get that the nonlinearity of any Boolean function $f\in\mathcal{B}_n$ can be computed as
    \begin{align*}
        nl(f) &= 2^{n-1} - \frac{1}{2}\max_{a\in\F_2^n}|W_f(a)|\\
              &= 2^{n-1} - \frac{1}{2}\max_{\alpha\in\F_{2^n}}|W_f(\alpha)|\\
              &= 2^{n-1} - \frac{1}{2}\max_{(\alpha,\beta)\in\F_{2^k}^2}|W_f(\alpha,\beta)|~(\text{if }n=2k\text{ is even}).
    \end{align*}
    As mentioned before, Boolean functions used in cryptosystems should have high nonlinearity to resist the best affine approximation and the fast correlation attack.
   Let $f$ be any $n$-variables Boolean function. It follows from the well-known Parseval relation that $\sum_{a\in\F_2^n}W_f^2(a)=2^{2n}$.
   This implies that $\max_{a\in\F_2^n}\left\lvert W_f(a)\right\rvert \geq  2^{n/2}$ and thus we can see that
   the nonlinearity of any $n$-variable Boolean function is upper-bounded by $nl(f)\le 2^{n-1}-2^{\frac{n}{2}-1}$.
    This bound is tight for even $n$ but is not tight for odd $n\geq 3$.
    If a Boolean function $f$ has nonlinearity achieving the upper bound with the equality,
    we say that $f$ is a bent function and clearly bent functions only exist in even number of variables.

    There exists a simple divide-and-conquer butterfly algorithm with complexity $O(n2^n)$ to compute the Walsh spectrum of any $n$-variable Boolean function from its truth table.
    Hence, it is easy to compute the nonlinearity of a Boolean function from its truth table in larger number of variables (around $30$ variables in a personal computer).
    However, as mentioned in Introduction, there are not much known results on the higher order nonlinearity of Boolean functions because computing the higher order nonlinearity, or even providing a tight lower bound, of a general Boolean function with high algebraic degree is an extremely hard task.
    In 2008, Carlet indicated in \cite{Carlet2008lowbound_NL_profile} that a lower bound on the $r$-th order nonlinearity of a Boolean function can be deduced from its $(r-1)$th-order nonlinearities of the first-order derivatives of this Boolean function.
    Thus, to obtain a lower bound on the third-order nonlinearity of a Boolean function, we need introduce the first-order and second-order derivatives of Boolean functions.
    \begin{definition}
        The first-order derivative of a Boolean function $f$ over $\F_{2^n}$ at a point $\alpha\in\F_{2^n}$ is defined as $D_{\alpha}f(x)=f(x)+f(x+\alpha)$.
        And the second-order derivative of a Boolean function $f$ at a pair $(\alpha,\beta)\in\F_{2^n}^2$ is defined as $D_{\beta}D_{\alpha}f(x)=f(x)+f(x+\alpha)+f(x+\beta)+f(x+\alpha+\beta)$.
    \end{definition}
    With the notions above, Carlet proposed the following lemma which can efficiently provide a lower bound on the $r$-th order nonlinearity of a given Boolean function when a lower bound on the $(r-1)$-th order nonlinearities of the first-order derivatives of $f$ are known.
    \begin{lemma}[\cite{Carlet2008lowbound_NL_profile}]\label{thm:High_order_nl_bound1}
        Let $f$ be an $n$-variable Boolean function, and let $0<r<n$ be an integer.
        We have
        \[nl_r(f)\ge 2^{n-1}-\frac{1}{2}\sqrt{2^{2n}-2\sum_{a\in\F_2^n}nl_{r-1}(D_af)}.\]
    \end{lemma}

    There is a class of character sums with polynomial arguments needed to be treated for proving the main results of this paper.
    To this end, we need the following two lemmas about the existence of solutions of the quadratic polynomial over the finite field $\F_{2^n}$ and algebraic geometry (we refer the reader to the original book~\cite{Stichtenoth2008book_algebraicfunctionfieldsandcodes} for more details).
    \begin{lemma}[\cite{Lidl1997FiniteFieldBook}]\label{lemma:hilbert90}
        Let $\F_{2^n}$ be the finite field of order $2^n$.
        Then $x^2+x=\alpha$ with $\alpha\in\F_{2^n}$ has a solution (actually two solutions) in $\F_{2^n}$, if and only if $\Tr_1^n(\alpha)=0$.
    \end{lemma}
    % the genus of the algebraic function field.
    \begin{lemma}[\cite{Stichtenoth2008book_algebraicfunctionfieldsandcodes}]\label{L:genus_K_F}
        Let $K=F(X,Y)$, where $X,Y$ are transcendentals over $F$.
        Then the genus $g$ of the function field $K/F$ satisfies
        \[g\le ([K : F(X)] - 1)([K : F(Y)] - 1).\]
    \end{lemma}

\section{A lower bound on the third-order nonlinearity of the simplest $\mathcal{PS}_{ap}$ bent function}

In this section, we focus on providing a lower bound on the third-order nonlinearity of the simplest 
partial spread affine plane ($\mathcal{PS}_{ap}$ for short) bent function.
We first introduce the definition of the $\mathcal{PS}_{ap}$ class.
Then we present some lemmas related to the multiplicative inverse functions, 
a lower bound on a class of character sums determined by the algebraic geometry
and the number of solutions for systems of trace functions. 
Therefore, we can determine the nonlinearities of the second-order derivatives of the simplest $\mathcal{PS}_{ap}$ bent function
and so we obtain a lower bound on the third-order nonlinearity of the simplest $\mathcal{PS}_{ap}$ 
bent function, which is much tighter than the previously known lower bounds (see table \ref{table:MyTableLabel} below).

  \subsection{The simplest $\mathcal{PS}_{ap}$ bent function}

In this subsection, we present the basic definition of the $\mathcal{PS}_{ap}$ class.
A collection of $k$-dimensional subspaces $\left\{ E_1,E_2,\dots,E_s \right\}$ of the vector space $\F_2^n$ is called a partial $k$-spread of $\F_2^n$, 
if $E_i\cap E_j = \{\bm{0}_n\}$ for $1\le i<j\le s$, where $\bm{0}_n$ is the all-zero vector in $\F_2^n$.
Further, a partial spread is called a spread, if it covers $\F_2^n$, \emph{i.e.}, the union of $E_i$ is equal to $\F_2^n$, where $1\le i\le s$.
Particularly, when $n=2k$, a partial $k$-spread of $\F_2^n$ is a set of pairwise supplementary of $k$-dimensional subspaces of $\F_2^n$ (such that the sum of any two of them is direct and equals $\F_2^n$).
Assume $n=2k$ and we then have $\F_{2^n}$ being isomorphic to the affine plane $\F_{2^k}\times\F_{2^k}$ (An affine plane is a vector space of dimension two in which one has ``forgotten'' where the origin is).
Considering $\F_{2^k}\times\F_{2^k}$, we then have $2^k+1$ different $n/2$-dimensional $\F_2$-subspaces of $\F_2^n$, which are $E_a=\left\{(x,ax)\middle| x\in\F_{2^k}\right\}$ for $a\in\F_{2^k}$ and $E_{\emptyset}=\left\{(0,x)\middle| x\in\F_{2^k}\right\}$.
Note that all elements $(x,y)$ of $E_a$ constitute a line $y=ax$ over $\F_{2^k}$ for every $a\in\F_{2^k}$, $E_{\emptyset}$ can be viewed as a line $y\in\F_{2^k}$ and all $2^k+1$ lines intersect only at the origin, that is why we use the term ``affine plane''.
These $2^k+1$ $n/2$-dimensional $\F_2$-subspaces of $\F_2^n$ constitute a spread, the so-called Desarguesian spread. 

In \cite{Dillon1974PSbent}, Dillon proposed constructions of bent functions in the $\mathcal{PS}^-$ (resp. $\mathcal{PS}^+$) class in $n$ variables, whose supports are the unions of $2^{k-1}$ (resp. $2^{k-1}+1$) different elements of a partial $k$-spread, where $n=2k$.
Especially, Dillon exhibited the $\mathcal{PS}_{ap}$ class, a subclass of $\mathcal{PS}^-$, over finite fields, whose elements have explicit mathematical expressions.
By taking any $2^{k-1}$ of the Desarguesian spread except $E_0$ and $E_{\emptyset}$ as the supports of a bent function will lead to a bent function of the $\mathcal{PS}_{ap}$ class, in the form
    \begin{equation*}\label{Eqn_PS_bent}
        f(x,y)=g\left(xy^{2^k-2}\right)=g\left(\frac{x}{y}\right),
    \end{equation*}
    where $g$ is a balanced Boolean function on $\F_{2^{k}}$ with $g(0)=0$, and $\frac{x}{y}$ is defined to be $0$ if $y=0$ (we shall always assume this kind of convention in the sequel).
    In this paper, taking the balanced Boolean function $g(x)$ over $\F_{2^k}$ as the trace function $\TRACE(x)$, which is the simplest balanced Boolean function on $\F_{2^k}$, we then have the simplest
    $\mathcal{PS}_{ap}$ bent function, \emph{i.e.},
    \begin{equation*}\label{sub-bent}
        f(x,y)=\TRACE\left(\frac{\lambda x}{y}\right),
    \end{equation*}
    where $(x,y)\in\F_{2^k}^2$, $\lambda\in\F_{2^k}^{*}$ and $\TRACE(x)=\sum\limits_{i=0}^{k-1}x^{2^i}$ is the trace function from $\F_{2^k}$ to $\F_2$.
   In  this paper, our aim is to obtain a lower bound on the third-order nonlinearity of the simplest $\mathcal{PS}_{ap}$ bent function.
    \subsection{The nonlinearities of the second-order derivatives of the simplest $\mathcal{PS}_{ap}$ bent function}
    As mentioned in Introduction, to derive a lower bound on the third-order nonlinearity of the simplest $\mathcal{PS}_{ap}$ bent function, 
    we need to determine the nonlinearities of the second-order derivatives of it.
    To this end, we first introduce some lemmas involved to the multiplicative inverse functions,
    a lower bound on a class of character sums determined by the algebraic geometry,
    and the number of solutions for systems of trace functions.
    These lemmas are needed in the sequel for proving our main result.
  
    For the finite field $\F_{2^n}$, the multiplicative inverse function of $\F_{2^n}$, defined as $I(x)=x^{2^n-2}$ (we shall use $x^{-1}$ to denote $x^{2^n-2}$ with the convention that $x^{-1}=\frac{1}{x}=0$ if $x=0$), besides, for any $v\in\F_{2^n}^*$, we define $I_v(x)=\Tr_1^n(vx^{-1})$. 
    Regarding the multiplicative inverse function, the following results are useful and we will use them in the sequel. 

    \begin{lemma}[\cite{tang2022invfunc}]\label{L:SumInv00}
        Let $n\geq 3$ be an arbitrary integer.
        We define
        $$L=\#\left\{c\in\F_{2^n} \middle| \mathrm{Tr}_1^n\left(\frac{1}{c^2+c+1}\right)=\mathrm{Tr}_1^n\left(\frac{c^2}{c^2+c+1}\right)=0\right\}.$$
        Then we have $L=2^{n-2}+\frac{3}{4}(-1)^n\widehat{I_1}(1)+\frac{1}{2}\left(1-(-1)^n\right)$, where $\widehat{I_1}(1)=1-\sum_{t=0}^{\lfloor n/2\rfloor}(-1)^{n-t}\frac{n}{n-t}{{n-t}\choose {t}}2^t$.
    \end{lemma}

    % Let $f$ be a function from $\F_{2^n}$ to $\F_{2^m}$.
    % For any $\gamma,\eta\in\F_{2^n}$ and $\omega\in\F_{2^m}$, let us define
    % \[\mathcal{S}_f(\gamma,\eta,\omega),\]
    % associated with $\mathcal{N}_f(\gamma,\eta,\omega)=\#\mathcal{S}_f(\gamma,\eta,\omega)$.

    \begin{lemma}\label{lemma:num_sol_second_dev}
        Let $n\ge 3$ be an integer.
        For $\alpha,\beta,\mu\in\F_{2^n}$ with $\lambda\in\F_{2^n}^*$, define $f(x)=\lambda x^{-1}$, and
        \begin{align*}
            \mathcal{S}_f(\alpha,\beta,\mu)=&\left\{x\in\F_{2^n}\middle|f(x)+f(x+\alpha)+f(x+\beta)+f(x+\alpha+\beta)=\mu\right\}\\
            =&\left\{ x\in\F_{2^n}\middle|\frac{\lambda}{x}+\frac{\lambda}{x+\alpha}+\frac{\lambda}{x+\beta}+\frac{\lambda}{x+\alpha+\beta}=\mu \right\}, 
        \end{align*}
        then, $\#\mathcal{S}_f(\alpha,\beta,\mu)$ can be determined as follows:
        \begin{enumerate}[label=(\arabic{*})]
            \item If $\alpha=\beta\in\F_{2^n}^*$ or $\alpha=0$ or $\beta=0$, then we have 
            \[\#\mathcal{S}_f(\alpha,\beta,\mu) = \left\{
                \begin{alignedat}{2}
                    &2^n,&&\text{ if }\mu = 0,\\
                    &0,  &&\text{ if }\mu\in\F_{2^n}^*.
                \end{alignedat}\right.\]
            \item If $\alpha,\beta\in\F_{2^n}^*$ such that $\alpha\ne\beta$, we have two conditions:
            \begin{enumerate}[ref=(\alph{*})]
                \item If $\lambda(\alpha^2+\beta^2+\alpha\beta)+\mu(\alpha^2\beta+\alpha\beta^2)=0$, we have
                $\{0,\alpha,\beta,\alpha+\beta\}\subseteq\mathcal{S}_f(\alpha,\beta,\mu)$.\label{item_a}
                \item If $\mu\ne 0$, $\TrN\left(\frac{\lambda\alpha}{\mu \beta(\alpha+\beta)}\right)=0$ and
                $\TrN\left(\frac{\lambda \beta}{\mu \alpha(\alpha+\beta)}\right)=0$, we have
                $\{y_0,y_0+\alpha,y_0+\beta,y_0+\alpha+\beta\}\subseteq\mathcal{S}_f(\alpha,\beta,\mu)$, where $y_0\notin\{0,\alpha,\beta,\alpha+\beta\}$.\label{item_b}
                % \item Otherwise, $\mathcal{S}_f(\alpha,\beta,\mu)=\emptyset$ and then $\mathcal{N}_f(\alpha,\beta,\mu)=0 $.
            \end{enumerate}
            Therefore, we have
            \[\#\mathcal{S}_f(\alpha,\beta,\mu) = \left\{
                \begin{alignedat}{2}
                    &8,&&\text{ if both two conditions }\ref{item_a}\text{ and }\ref{item_b}\text{ hold,}\\
                    &4,&&\text{ if only one condition holds,}\\
                    &0,&&\text{ otherwise.}
                \end{alignedat}\right.\]
        \end{enumerate}
    \end{lemma}
    \begin{proof}
        The proof is analogue to the proof of Lemma 13 in \cite{tang2022invfunc} and we omit it.
    \end{proof}
    \begin{remark}
        For any $\alpha\in\F_{2^n}^*$, there exist $L-4$ different $\beta$
        such that $\mathcal{N}_f(\alpha,\beta,\mu)=8$ for some $\lambda\in\F_{2^n}^*$ and $\mu\in\F_{2^n}$.
        Indeed, consider both conditions \ref{item_a} and \ref{item_b}, $\alpha,\beta\in\F_{2^n}^*$, $\alpha\ne\beta$ and $\mu\ne 0$
        can tell us $\mu(\alpha^2\beta+\alpha\beta^2)\ne 0$,
        resulting in $\lambda(\alpha^2+\beta^2+\alpha\beta)\ne 0$,
        which implies $\frac{\beta}{\alpha}\notin\F_4$.
        So assume $\mu=\frac{\lambda(\alpha^2+\beta^2+\alpha\beta)}{\alpha^2\beta+\alpha\beta^2}$ and take it 
        into $\TrN\left(\frac{\lambda \alpha}{\mu \beta(\alpha+\beta)}\right)=0$
        and $\TrN\left(\frac{\lambda \beta}{\mu \alpha(\alpha+\beta)}\right)=0$ respectively,
        we have $\TrN\left(\frac{1}{\gamma^2+\gamma+1}\right)=0$ and $\TrN\left(\frac{\gamma^2}{\gamma^2+\gamma+1}\right)=0$,
        where $\gamma=\frac{\beta}{\alpha}\in\F_{2^n}\setminus\F_{4}$.
        Therefore, according to Lemma \ref{L:SumInv00},
        the number of $\gamma=\frac{\beta}{\alpha}\in\F_{2^n}\setminus\F_{4}$ satisfying
        $\TrN\left(\frac{1}{\gamma^2+\gamma+1}\right)=0$ and $\TrN\left(\frac{\gamma^2}{\gamma^2+\gamma+1}\right)=0$
        is $L-4$ since we need to exclude $\gamma\in\F_4$ satisfying both trace functions.
    \end{remark}


The following lemma present a lower bound on a class of character sums in which we need some basic knowledge
about  algebraic geometry (see more details in \cite{Stichtenoth2008book_algebraicfunctionfieldsandcodes}).

    \begin{lemma}\label{lemma:charactersums}
        Let $k\ge 3$ be a positive integer and assume
        \[S(\alpha,\beta,v)=\sum_{x\in\F_{2^k}}(-1)^{\TRACE\left( \frac{\alpha}{x+\beta}+\frac{\alpha}{x}+vx \right)},\]
        where $\alpha,\beta,v\in\F_{2^k}^*$.
        We have
        \[\left\lvert S(\alpha,\beta,v)\right\rvert\le 2\left\lfloor 2^{\frac{k}{2}+1}\right\rfloor+4 .\]
    \end{lemma}
    \begin{proof}
        Note that $S(1,\beta/\alpha,v\alpha)=S(\alpha,\beta,v)$.
        Determining the value of $S(\alpha,\beta,v)$ is equivalent to obtain the number of $x\in\F_{2^k}$
        for which $\TRACE\left( \frac{1}{x+\beta}+\frac{1}{x}+vx \right)=0$.
        By Lemma $\ref{lemma:hilbert90}$, it is equivalent to calculate the number of solutions $(x,y)\in\F_{2^k}^2$ of $y^2+y=\frac{1}{x+\beta}+\frac{1}{x}+vx$.

        Let us define
        \[\mathcal{S}_{\beta,v}=\left\{(x,y)\in\F_{2^k}\times\F_{2^k}\middle|y^2+y=\frac{1}{x+\beta}+\frac{1}{x}+vx\right\}.\]
        Note that $y\mapsto y^2+y$ is $2$-to-$1$, then we have
        \begin{equation}\label{eq:tracesum_S}
            S(\alpha,\beta,v)=\frac{\#\mathcal{S}_{\beta,v}}{2}-\left(2^k-\frac{\#\mathcal{S}_{\beta,v}}{2}\right)=\#\mathcal{S}_{\beta,v}-2^k.
        \end{equation}
        Note that $\#\mathcal{S}_{\beta,v}$ is even and then $S(\alpha,\beta,v)$ must be even, too.
        Consider the function field $K=\F_{2^k}(x,y)$ with defining equation
        \begin{equation}\label{eq:trace_curve}
            y^2+y=\frac{1}{x+\beta}+\frac{1}{x}+vx.
        \end{equation}
        By Lemma \ref{L:genus_K_F}, we can easily obtain that the genus of $K$ is not greater than $2-\delta_v$,
        where $\delta_v=1$ if $v=0$ and $\delta_v=0$ otherwise.
        Denote by $\mathcal{N}$ the number of the places with degree one of $K/\F_{2^k}$.
        Then by Serre bound\cite{Serre1982serrebound}, we have
        \begin{equation}\label{eq:N_genus_inequality}
            \left\lvert \mathcal{N}-(2^k+1)\right\rvert\le g\left\lfloor 2^{\frac{k}{2}+1}\right\rfloor,
        \end{equation}
        where $g$ is the genus of the function field $K/\F_{2^k}$.
        And we also need to the equality
        \begin{equation}\label{eq:N_S_M_equality}
            \mathcal{N}=\#\mathcal{S}_{\beta,v}-\mathcal{M}_{\beta,v},
        \end{equation}
        where $\mathcal{M}_{\beta,v}$ is the number of the points at infinity of Equation \eqref{eq:trace_curve}.
        So we homogenize \eqref{eq:trace_curve} to
        \begin{equation}\label{eq:homogenize}
            \left( \frac{Y}{Z} \right)^2+\frac{Y}{Z}=\frac{Z}{X+\beta Z}+\frac{Z}{X}+\frac{vX}{Z}.
        \end{equation}
        Multiplying both sides of \eqref{eq:homogenize} by $Z^2X\left( X+\beta Z \right)$ and then let $Z=0$,
        we have
        \[X^2Y^2=0,\]
        hence the points at infinite are $(1:0:0)$ and $(0:1:0)$.
        We now consider the multiplicity of roots of $(0 : 1 : 0)$ and $(1 : 0 : 0)$, respectively.
        For the point $(0 : 1 : 0 )$, \emph{i.e.}, $Y = 1$, we have
        \begin{equation}\label{eq:points_010}
            \left( \frac{1}{z} \right)^2+\frac{1}{z}=\frac{z}{x+\beta z}+\frac{z}{x}+\frac{vx}{z}.
        \end{equation}
        And multiplying \eqref{eq:points_010} by $z^2x(x+\beta z)$ gives
        \[x^2+\beta xz+R_{\beta,v}(x,z)=0,\]
        where $R_{\beta,v}(x,z)=\beta xz^2+x^2z+\beta z^4+v\beta x^2z^2+vx^3z$ is a polynomial
        such that its every monomial has algebraic degree at least $3$.
        This gives $(0 : 1 : 0)$ is a root of multiplicity $2$.

        For the point $(1 : 0 : 0)$, \emph{i.e.}, $X = 1$, we have
        \begin{equation}\label{eq:points_100}
            \left( \frac{y}{z} \right)^2+\frac{y}{z}=\frac{z}{1+\beta z}+z+\frac{v}{z}.
        \end{equation}
        And multiplying \eqref{eq:points_100} by $z^2(1+\beta z)$ gives
        \[vz+v\beta z^2+y^2+zy+\beta y^2z+\beta yz^2+\beta z^4=0.\]
        Note that when $v=0$, we have
        \[y^2+zy+\beta y^2z+\beta yz^2+\beta z^4=0,\]
        which implies that $(1:0:0)$ is a root of multiplicity $2$.

        Therefore, Equation \eqref{eq:trace_curve} has at most $4$ points at infinity, \emph{i.e.}
        $\mathcal{M}_{\beta,v}\le 4$.
        So combining \eqref{eq:tracesum_S},\eqref{eq:N_genus_inequality},\eqref{eq:N_S_M_equality} and the fact that
        $S(\alpha,\beta,v)$ is even, we can get our assertion
        \[\left\lvert S(\alpha,\beta,v)\right\rvert \le 2\left\lfloor 2^{\frac{k}{2}+1}\right\rfloor+4.\]
    \end{proof}

    \begin{lemma}\label{lemma:N_ij_trace}
        Assume  $k\ge 3$ be a positive integer, let
        \[ N_{i,j} =\#\left\{x\in\F_{2^k}\middle|\TRACE\left(\theta_1x+\gamma_1\right)=i,\TRACE\left(\theta_2x+\gamma_2\right)=j\right\}, \]
        where  $\gamma_1,\gamma_2\in\F_{2^k}$ and $\theta_1,\theta_2\in\F_{2^k}^*$ are distinct. Then $N_{0,0} =2^{k-2}$.
    \end{lemma}

   \begin{proof}
        By definition, from two equations 
        \[N_{0,0}+N_{0,1}=\#\left\{x\in\F_{2^k}\middle|\TRACE\left(\theta_1x+\gamma_1\right)=0\right\}=2^{k-1}\]
        and 
        \[N_{1,1}+N_{0,1}=\#\left\{x\in\F_{2^k}\middle|\TRACE\left(\theta_2x+\gamma_2\right)=1\right\}=2^{k-1},\]
        we obtain $N_{0,0} = N_{1,1}$. 
        Besides, we have $N_{0,0}+N_{1,1} = \#\left\{x\in\F_{2^k}\middle|\TRACE\left((\theta_1+\theta_2)x+(\gamma_1+\gamma_2)\right)=0\right\}=2^{k-1}$
        since the trace function is balanced if $\theta_1\ne\theta_2$.
        Therefore $N_{0,0}=2^{k-2}$. This completes the proof.
   \end{proof}

    \begin{lemma}\label{lemma:N_ijk_trace}
        Assume $k\ge 3$ be a positive integer, let
        \[ N_{i_1,i_2,i_3}=\#\left\{x\in\F_{2^k}\middle| \TRACE\left(\theta_1x+\gamma_1\right)=i_1,\TRACE\left(\theta_2x+\gamma_2\right)=i_2,\TRACE\left(\theta_3x+\gamma_3\right)=i_3 \right\},\]
        where  $\gamma_1,\gamma_2,\gamma_3\in\F_{2^k}$ and $\theta_1,\theta_2,\theta_3\in\F_{2^k}^*$ are distinct and satisfy
        $\theta_3\ne\theta_1+\theta_2$. Then $N_{0,0,0}= 2^{k-3}$.
    \end{lemma}

    \begin{proof}
        By Lemma \ref{lemma:N_ij_trace} we have
        \begin{equation}\label{eq:from_lemma_1}\left\{\begin{alignedat}{3}
        &N_{0,0,0}+N_{0,0,1}=\#\left\{x\in\F_{2^k}\middle|\TRACE\left(\theta_1x+\gamma_1\right)=0, \TRACE\left(\theta_2x+\gamma_2\right)=0\right\}=2^{k-2}\\
        &N_{0,0,0}+N_{0,1,0}=\#\left\{x\in\F_{2^k}\middle|\TRACE\left(\theta_1x+\gamma_1\right)=0, \TRACE\left(\theta_3x+\gamma_3\right)=0\right\}=2^{k-2}\\
        &N_{0,0,0}+N_{1,0,0}=\#\left\{x\in\F_{2^k}\middle|\TRACE\left(\theta_2x+\gamma_2\right)=0, \TRACE\left(\theta_3x+\gamma_3\right)=0\right\}=2^{k-2}.\\
        \end{alignedat}\right.\end{equation}
        Thus, $N_{0,0,1}=N_{0,1,0}=N_{1,0,0}$. With the same reason we can also obtain  $N_{0,1,1}=N_{1,0,1}=N_{1,1,0}$.
        As a result of $\theta_1+\theta_2+\theta_3\ne 0$, we obtain two equations
        \begin{equation}\label{eq:sum_three_trace_1}
            N_{0,0,1}+N_{0,1,0}+N_{1,0,0}+N_{1,1,1}=\#\left\{x\in\F_{2^k}\middle|\TRACE\left(\left(\theta_1+\theta_2+\theta_3\right)x+\left(\gamma_1+\gamma_2+\gamma_3\right)\right)=1\right\}=2^{k-1}
        \end{equation}
        and 
        \begin{equation}\label{eq:sum_three_trace_2}
            N_{0,1,1}+N_{1,0,1}+N_{1,1,0}+N_{0,0,0}=\#\left\{x\in\F_{2^k}\middle|\TRACE\left(\left(\theta_1+\theta_2+\theta_3\right)x+\left(\gamma_1+\gamma_2+\gamma_3\right)\right)=0\right\}=2^{k-1}.
        \end{equation}
        Combining Equation \eqref{eq:sum_three_trace_1}, Equation \eqref{eq:sum_three_trace_2} with equations
        \begin{equation}\label{eq:sum_N_0jk}\left\{\begin{alignedat}{2}
            &N_{0,0,0}+N_{0,0,1}+N_{0,1,0}+N_{0,1,1}=\#\left\{x\in\F_{2^k}\middle|\TRACE\left(\theta_1x+\gamma_1\right)=0\right\}=2^{k-1}\\
            &N_{1,0,0}+N_{1,0,1}+N_{1,1,0}+N_{1,1,1}=\#\left\{x\in\F_{2^k}\middle|\TRACE\left(\theta_1x+\gamma_1\right)=1\right\}=2^{k-1},\\
        \end{alignedat}\right.\end{equation}
        and by the two facts obtained earlier $N_{0,0,1}=N_{0,1,0}=N_{1,0,0}$, $N_{0,1,1}=N_{1,0,1}=N_{1,1,0}$, we obtain $N_{0,0,1}=N_{0,1,1}$. 
        Consequently, Equations \eqref{eq:from_lemma_1} and Equations \eqref{eq:sum_N_0jk} can be transformed into 
        $N_{0,0,0}+N_{0,0,1}=2^{k-2}$ and $N_{0,0,0}+3N_{0,0,1}=2^{k-1}$, respectively.
        Clearly, $N_{0,0,0}=N_{0,0,1}=2^{k-3}$ is the solution. This completes the proof.
    \end{proof}

    With two lemmas proved above, we can determine the nonlinearities of all the second-order derivatives of the simplest $\mathcal{PS}_{ap}$ bent function.
    \begin{theorem}\label{thm:nl_DaDbf}
        Let $k\ge 3$ be an integer and $n=2k$.
        For the nonlinearity of the second-order derivative of
        the simplest $\mathcal{PS}_{ap}$ bent function $f(x,y)=\TRACE\left(\frac{\lambda x}{y}\right)$,
        we have three cases based on the value of the derivative $\alpha=(\alpha_1,\alpha_2)$ as follows:
        \begin{enumerate}[label=(\arabic{*})]
            \item For every $\alpha=(\alpha_1,\alpha_2)\in\F_{2^k}\times\F_{2^k}^*$,
            when $\beta$ ranges over $\F_{2^n}$, we have
            \begin{equation}\label{res:nontrivil_nl}
                nl(D_{\beta}D_{\alpha}f)=\begin{cases}
                    2^{2k-1}-2^{k+2},&2^k(L-4)\text{ times}\\
                    2^{2k-1}-2^{k+1},&2^k(2^k+2-L)\text{ times}\\
                    0,&1\text{ time},%\footnote[1]{This happends if $ \beta=0 $},
                \end{cases}
            \end{equation}
            with $nl(D_{\beta}D_{\alpha}f)\ge 2^{2k-1}-2^k\left\lfloor 2^{\frac{k}{2}+1}\right\rfloor-2^{k+1}$ occuring $2^{k+1}-1$ times.
            \item For every $\alpha=(\alpha_1,0)\in\F_{2^k}^*\times\{0\}$, when $\beta$ ranges over $\F_{2^n}$,
            we have $nl(D_{\beta}D_{\alpha}f)=0$ occuring $2^k$ times,
            otherwise, $nl(D_{\beta}D_{\alpha}f)\ge 2^{2k-1}-2^k\left\lfloor 2^{\frac{k}{2}+1}\right\rfloor-2^{k+1}$ occurs $2^{2k}-2^k$ times.
            \item For $\alpha=(0,0)$, we have $nl(D_{\beta}D_{\alpha}f) = 0$ occuring $2^n$ times.
        \end{enumerate}
    \end{theorem}

    \begin{proof}
        Let us consider the Walsh transform of the second-order derivative of $f(x,y)=\TRACE\left(\frac{\lambda x}{y}\right)$ at the points $\alpha=(\alpha_1,\alpha_2),\beta=(\beta_1,\beta_2)\in\F_{2^k}^2$ with $\lambda\in\F_{2^k}^*$.
        We have
        \begin{align*}\label{eq:secondordersum}
            &W_{D_{\beta}D_{\alpha}f}(\mu,\nu)\nonumber\\
            =&\sum_{x\in\F_{2^k}}\sum_{y\in\F_{2^k}}(-1)^{\TRACE\left(\frac{\lambda x}{y}+\frac{\lambda (x+\alpha_1)}{y+\alpha_2}+\frac{\lambda (x+\beta_1)}{y+\beta_2}+\frac{\lambda (x+\alpha_1+\beta_1)}{y+\alpha_2+\beta_2}+\mu x+\nu y\right)}\nonumber\\
            =&\sum_{y\in\F_{2^k}}(-1)^{\TRACE\left(\frac{\lambda\alpha_1}{y+\alpha_2}+\frac{\lambda\beta_1}{y+\beta_2}+\frac{\lambda(\alpha_1+\beta_1)}{y+\alpha_2+\beta_2}+\nu y\right)}\nonumber\\
            &\times \sum_{x\in\F_{2^k}}(-1)^{\TRACE\left(\left(\frac{\lambda}{y}+\frac{\lambda}{y+\alpha_2}+\frac{\lambda}{y+\beta_2}+\frac{\lambda}{y+\alpha_2+\beta_2}+\mu\right)x\right)}\nonumber\\
            =&\begin{cases}
                2^k\sum_{y\in S}(-1)^{\TRACE\left(\frac{\lambda\alpha_1}{y+\alpha_2}+\frac{\lambda\beta_1}{y+\beta_2}+\frac{\lambda(\alpha_1+\beta_1)}{y+\alpha_2+\beta_2}+\nu y\right)},&~\text{if}~\frac{\lambda}{y}+\frac{\lambda}{y+\alpha_2}+\frac{\lambda}{y+\beta_2}+\frac{\lambda}{y+\alpha_2+\beta_2}=\mu~\text{has solutions},\\
                0, &~\text{otherwise},
            \end{cases}
        \end{align*}
        where $S$ is the set of solutions of equation
        \begin{equation}\label{eq:coefficient}
            \frac{\lambda}{y}+\frac{\lambda}{y+\alpha_2}+\frac{\lambda}{y+\beta_2}+\frac{\lambda}{y+\alpha_2+\beta_2}=\mu.
        \end{equation}

        For the nonlinearity of $D_{\beta}D_{\alpha}f$, we only need to consider $\max_{\mu,\nu}|W_{D_{\beta}D_{\alpha}f}(\mu,\nu)|$ for every points $\alpha,\beta$.
        So we just consider the cases such that Equation \eqref{eq:coefficient} has solutions, since in those cases, we have $\left\lvert W_{D_{\beta}D_{\alpha}f}(\mu,\nu)\right\rvert$ no less than $0$.
        As for $W_{D_{\beta}D_{\alpha}f}(\mu,\nu)$, by Lemma \ref{lemma:num_sol_second_dev}, it is enough to divide points $\alpha,\beta$ into three cases by the number of solutions
        of Equation \eqref{eq:coefficient}:

        \begin{enumerate}[label=\textbf{Case \arabic*},wide = 0pt]
            \item If $\alpha_2=\beta_2\in\F_{2^k}^*$ or $\alpha_2=0$ or $\beta_2=0$ and in case $\mu=0$, Equation \eqref{eq:coefficient} has $2^k$ solutions, which actually are all elements of $\F_{2^k}$, then we have
            \begin{equation}\label{eq:case2ksolutions}
                W_{D_{\beta}D_{\alpha}f}(0,\nu)=2^k\sum_{y\in\F_{2^k}}(-1)^{\TRACE\left(\frac{\lambda\alpha_1}{y+\alpha_2}+\frac{\lambda\beta_1}{y+\beta_2}+\frac{\lambda(\alpha_1+\beta_1)}{y+\alpha_2+\beta_2}+\nu y\right)}.
            \end{equation}

            For the trivial cases, if $\alpha_2=\beta_2\in\F_{2^k}^*$ with $\alpha_1=\beta_1$ or $\alpha_2=\beta_2=0$, Equation \eqref{eq:case2ksolutions} can be transformed into a simple form:
            \[W_{D_{\beta}D_{\alpha}f}(0,\nu)=2^k\sum_{y\in\F_{2^k}}(-1)^{\TRACE\left(\nu y\right)}.\]
            Clearly $\max_{\nu}|W_{D_{\beta}D_{\alpha}f}(0,\nu)|=|W_{D_{\beta}D_{\alpha}f}(0,0)|=2^{2k}$.

            For other cases, we will give the upper bounds on $\max_{v}|W_{D_{\beta}D_{\alpha}f}(0,v)|$:
            assume $\alpha_2=\beta_2\in\F_{2^k}^*$ and $\alpha_1\ne\beta_1$, by Lemma \ref{lemma:charactersums} we then have
            \[\left\lvert W_{D_{\beta}D_{\alpha}f}(0,v)\right\rvert =2^k\left\lvert \sum_{y\in\F_{2^k}}(-1)^{\TRACE\left(\frac{\lambda(\alpha_1+\beta_1)}{y+\alpha_2}+\frac{\lambda(\alpha_1+\beta_1)}{y}+vy\right)}\right\rvert\le 2^{k+1}\left\lfloor 2^{\frac{k}{2}+1}\right\rfloor+2^{k+2}.\]
            The case $\alpha_2=0$ or $\beta_2=0$ lead to the analogue proof and we omit it.
            Therefore, in the cases of $\alpha_2=\beta_2\in\F_{2^k}^*$ or $\alpha_2=0$ or $\beta_2=0$, we have
            \[\max_{\mu,\nu}|W_{D_{\beta}D_{\alpha}f}(\mu,\nu)|\le 2^{k+1}\left\lfloor 2^{\frac{k}{2}+1}\right\rfloor+2^{k+2}.\]

            \item If $\alpha_2,\beta_2$ are two different elements of $\F_{2^k}^*$ and $\mu$ is equal to $\frac{\lambda(\alpha_2^2+\beta_2^2+\alpha_2\beta_2)}{\alpha_2^2\beta_2+\alpha_2\beta_2^2}$,
            we are sure that Equations \eqref{eq:coefficient} has at least $4$ solutions $\{0,\alpha_2,\beta_2,\alpha_2+\beta_2\}$, then we have two subcases based on the number of solutions is $8$ or $4$:
            \begin{enumerate}[label=(\arabic{*})]
                \item When $\mu\ne 0$, if two different elements $\alpha_2,\beta_2\in\F_{2^k}^*$ satisfy 
                \begin{equation}\label{eq:last_four_solution_condition}
                    \TRACE\left(\frac{\lambda\alpha_2}{\mu\beta_2(\alpha_2+\beta_2)}\right)=\TRACE\left(\frac{\lambda\beta_2}{\mu\alpha_2(\alpha_2+\beta_2)}\right)=0,
                \end{equation}
                then $\{y_0,y_0+\alpha_2,y_0+\beta_2,y_0+\alpha_2+\beta_2\}$ are another $4$ solutions of Equation \eqref{eq:coefficient}, where $y_0\notin\{0,\alpha_2,\beta_2,\alpha_2+\beta_2\}$, that is, the number of solutions of Equation \eqref{eq:coefficient} is $8$.
                \item Otherwise, $\{0,\alpha_2,\beta_2,\alpha_2+\beta_2\}$ are the only $4$ solutions of Equation \eqref{eq:coefficient}.
            \end{enumerate}
            So we can calculate $W_{D_{\beta}D_{\alpha}f}(\mu,\nu)$ for two cases based on the number of solutions of Equation \eqref{eq:coefficient}.
            \begin{enumerate}[label=\textbf{Subcase \Alph{*}},itemindent=*,wide=\parindent]
                \item We first consider the case where Equation \eqref{eq:coefficient} has $4$ solutions
                $\{0,\alpha_2,\beta_2,\alpha_2+\beta_2\}$, \emph{i.e.}, $S=\{0,\alpha_2,\beta_2,\alpha_2+\beta_2\}$.
                Assume $y\in S$, we have
                \begin{align}\label{eq:simpleforms_4}
                    &W_{D_{\beta}D_{\alpha}f}(\mu,\nu)\nonumber\\
                    =&2^k\left[1+(-1)^{\TRACE\left((\alpha_1+\beta_1)\mu+ (\alpha_2+\beta_2)\nu\right)}\right]\nonumber\\
                    &\cdot
                    \left[(-1)^{\TRACE\left(\frac{\lambda\alpha_1}{y+\alpha_2}+\frac{\lambda\beta_1}{y+\beta_2}+\frac{\lambda(\alpha_1+\beta_1)}{y+\alpha_2+\beta_2}+ y\nu\right)}+
                    (-1)^{\TRACE\left(\frac{\lambda\alpha_1}{y}+\frac{\lambda\beta_1}{y+\alpha_2+\beta_2}+\frac{\lambda(\alpha_1+\beta_1)}{y+\beta_2}+ (y+\alpha_2)\nu\right)}\right]\nonumber\\
                    =&2^k\left[1+(-1)^{\TRACE\left((\alpha_1+\beta_1)\mu+ (\alpha_2+\beta_2)\nu\right)}\right]\nonumber\\
                    &\cdot
                    (-1)^{\TRACE\left(\frac{\lambda\alpha_1}{y+\alpha_2}+\frac{\lambda\beta_1}{y+\beta_2}+\frac{\lambda(\alpha_1+\beta_1)}{y+\alpha_2+\beta_2}+ y\nu\right)}\cdot
                    \left[1+(-1)^{\TRACE\left(\frac{\lambda\alpha_1}{y}+\frac{\lambda\alpha_1}{y+\alpha_2}+\frac{\lambda\alpha_1}{y+\beta_2}+\frac{\lambda\alpha_1}{y+\alpha_2+\beta_2}+\nu\alpha_2\right)}\right]\nonumber\\
                    =&2^k\left[1+(-1)^{\TRACE\left((\alpha_1+\beta_1)\mu+ (\alpha_2+\beta_2)\nu\right)}\right]\cdot
                    \left[1+(-1)^{\TRACE\left(\alpha_1\mu+\alpha_2\nu\right)}\right]\cdot
                    (-1)^{\TRACE\left(\frac{\lambda\alpha_1}{y+\alpha_2}+\frac{\lambda\beta_1}{y+\beta_2}+\frac{\lambda(\alpha_1+\beta_1)}{y+\alpha_2+\beta_2}+ y\nu\right)}\nonumber\\
                    =&\begin{cases}
                        2^{k+2}\cdot(-1)^{\TRACE\left(\frac{\lambda\alpha_1}{y+\alpha_2}+\frac{\lambda\beta_1}{y+\beta_2}+\frac{\lambda(\alpha_1+\beta_1)}{y+\alpha_2+\beta_2}+ y\nu\right)},&\text{if}~\TRACE\left(\alpha_2\nu+\alpha_1\mu\right)=0 ~
                        \text{and}~\TRACE\left(\beta_2\nu+\beta_1 \mu\right)=0 \\
                        0,~&\text{otherwise}.
                    \end{cases}
                \end{align}
                Observing \eqref{eq:simpleforms_4} we can find that $|W_{D_{\beta}D_{\alpha}f}(\mu,\nu)|$ only has two possible values $\{0,2^{k+2}\}$.
                Furthermore, for all $\alpha=(\alpha_1,\alpha_2),\beta=(\beta_1,\beta_2)\in\F_{2^k}\times\F_{2^k}^*$ such that $\alpha_2\ne\beta_2$ and $\mu=\frac{\lambda(\alpha_2^2+\beta_2^2+\alpha_2\beta_2)}{\alpha_2^2\beta_2+\alpha_2\beta_2^2}$, the number of solutions $\nu\in\F_{2^k}$ for the system
                \begin{equation}\label{eq:max_foursolution_condition}
                    \left\{
                    \begin{alignedat}{2}
                        \TRACE\left(\alpha_2\nu+\alpha_1\mu\right)&=0\\
                        \TRACE\left(\beta_2\nu +\beta_1 \mu\right)&=0
                    \end{alignedat}
                    \right.
                \end{equation}
                is $2^{k-2}$, according to Lemma \ref{lemma:N_ij_trace}.
                Thus, for all points $\alpha=(\alpha_1,\alpha_2),\beta=(\beta_1,\beta_2) \in\F_{2^k}\times\F_{2^k}^*$, $\alpha_2\ne\beta_2$
                and $\mu=\frac{\lambda(\alpha_2^2+\beta_2^2+\alpha_2\beta_2)}{\alpha_2^2\beta_2+\alpha_2\beta_2^2}$
                such that don't satisfy Equations \eqref{eq:last_four_solution_condition}, we have
                \[\max_{\mu,\nu}|W_{D_{\beta}D_{\alpha}f}(\mu,\nu)|=2^{k+2}.\]

                \item The other is that if Equation \eqref{eq:coefficient} has $8$ solutions,
                that is, $\alpha_2,\beta_2$ and $\mu$ satisfy system \eqref{eq:last_four_solution_condition}.
                Then we have
                \begin{align*}
                &W_{D_{\beta}D_{\alpha}f}(\mu,\nu)\nonumber\\
                    =&2^k\left[1+(-1)^{\TRACE\left((\alpha_1+\beta_1)\mu+ (\alpha_2+\beta_2)\nu\right)}\right]\cdot
                    \left[1+(-1)^{\TRACE\left(\alpha_1\mu+\alpha_2\nu\right)}\right]\nonumber\\
                    &\cdot
                    \left[(-1)^{\TRACE\left(\frac{\lambda\alpha_1}{\alpha_2}+\frac{\lambda\beta_1}{\beta_2}+\frac{\lambda(\alpha_1+\beta_1)}{\alpha_2+\beta_2}\right)}+(-1)^{\TRACE\left(\frac{\lambda\alpha_1}{y_0+\alpha_2}+\frac{\lambda\beta_1}{y_0+\beta_2}+\frac{\lambda(\alpha_1+\beta_1)}{y_0+\alpha_2+\beta_2}+ y_0\nu\right)}\right]\nonumber\\
                    =&(-1)^{c_0}2^k\cdot\left[1+(-1)^{\TRACE\left((\alpha_1+\beta_1)\mu+ (\alpha_2+\beta_2)\nu\right)}\right]\cdot
                    \left[1+(-1)^{\TRACE\left(\alpha_1\mu+\alpha_2\nu\right)}\right]\cdot\left[1+(-1)^{c_0+c_1}\right]\nonumber\\
                    =&\begin{cases}
                        2^{k+3}\cdot(-1)^{c_0},&\text{if }\TRACE\left(\alpha_1\mu+\alpha_2\nu\right)=\TRACE\left(\beta_1\mu+\beta_2\nu\right)=c_0+c_1=0,\\
                        0,&\text{otherwise},
                    \end{cases}
                \end{align*}
                where $y_0\notin\{0, \alpha_2, \beta_2, \alpha_2+\beta_2\}$, 
                $c_0=\TRACE\left(\frac{\lambda\alpha_1}{\alpha_2}+\frac{\lambda\beta_1}{\beta_2}+\frac{\lambda(\alpha_1+\beta_1)}{\alpha_2+\beta_2}\right)$
                and 
                $c_1= \TRACE\left(\frac{\lambda\alpha_1}{y_0+\alpha_2}+\frac{\lambda\beta_1}{y_0+\beta_2}+\frac{\lambda(\alpha_1+\beta_1)}{y_0+\alpha_2+\beta_2}+\nu y_0\right)$. 
                By Lemma \ref{lemma:N_ijk_trace},
                for all $\alpha=(\alpha_1,\alpha_2),\beta=(\beta_1,\beta_2)\in\F_{2^k}\times\F_{2^k}^*$ such that
                $\alpha_2\ne\beta_2$
                and $y_0\notin\{0,\alpha_2,\beta_2,\alpha_2+\beta_2\}$,
                there always exists solutions $\nu\in\F_{2^k}$ for the system 
                \begin{empheq}[left=\empheqbiglbrace]{align*}
                    &\TRACE\left(\alpha_2\nu + \alpha_1\mu\right)=0\\
                    &\TRACE\left(\beta_2 \nu + \beta_1\mu \right)=0\\
                    &\TRACE\left(y_0\nu +\frac{\lambda\alpha_1}{\alpha_2}+\frac{\lambda\beta_1}{\beta_2}+\frac{\lambda(\alpha_1+\beta_1)}{\alpha_2+\beta_2}+\frac{\lambda\alpha_1}{y_0+\alpha_2}+\frac{\lambda\beta_1}{y_0+\beta_2}+\frac{\lambda(\alpha_1+\beta_1)}{y_0+\alpha_2+\beta_2} \right)=0,
                \end{empheq}
                and the number of solutions $\nu$ is $2^{k-3}$.
                So we conclude that for all points $\alpha=(\alpha_1,\alpha_2),\beta=(\beta_1,\beta_2)\in\F_{2^k}\times\F_{2^k}^*$
                such that $\alpha_2\ne\beta_2$
                and $\mu=\frac{\lambda(\alpha_2^2+\beta_2^2+\alpha_2\beta_2)}{\alpha_2^2\beta_2+\alpha_2\beta_2^2}$
                satisfying Equations \eqref{eq:last_four_solution_condition}, we have
                \[\max_{\mu,\nu}|W_{D_{\beta}D_{\alpha}f}(\mu,\nu)|=2^{k+3}.\]
            \end{enumerate}
            \item For every $\alpha_2,\beta_2\in\F_{2^k}^*$ such that $\alpha_2\ne\beta_2$,
            there exist some $\mu$ such that $S=\{y_0,y_0+\alpha_2,y_0+\beta_2,y_0+\alpha_2+\beta_2\}$
            are the only $4$ solutions of
            Equation \eqref{eq:coefficient}, where $y_0\notin\{0, \alpha_2, \beta_2, \alpha_2+\beta_2\}$. Fortunately,
            we don't need to treat with those $\mu$.
            Indeed, in that case,
            the maximal possible value is not greater than the result $2^{k+2}$ of Case 2 where Equation \eqref{eq:coefficient} has $4$ solutions
            $\{0,\alpha_2,\beta_2,\alpha_2+\beta_2\}$, that is,
            \[ |W_{D_{\beta}D_{\alpha}f}(\mu,\nu)|=2^k\left\lvert\sum_{y\in S}(-1)^{\TRACE\left(\frac{\lambda\alpha_1}{y+\alpha_2}+\frac{\lambda\beta_1}{y+\beta_2}+\frac{\lambda(\alpha_1+\beta_1)}{y+\alpha_2+\beta_2}+ y\nu\right)}\right\rvert\le 2^{k+2}=|W_{D_{\beta}D_{\alpha}f}(\mu_0,\nu_0)|, \]
            where $\nu_0$ satisfies the system \eqref{eq:max_foursolution_condition}.
        \end{enumerate}
    \end{proof}

\subsection{A lower bound on the third-order nonlinearity of the simplest $\mathcal{PS}_{ap}$ bent function}
    After obtaining the nonlinearities of all the second-order derivatives of the simplest $\mathcal{PS}_{ap}$ bent function, we can derive a lower bound on the third-order nonlinearity of it by Lemma \ref{thm:High_order_nl_bound1}.
    Indeed, applying twice Lemma \ref{thm:High_order_nl_bound1}, that is, taking
    \[nl_{r-1}(D_af) \ge 2^{n-1}-\frac{1}{2}\sqrt{2^{2n}-2\sum_{b\in\F_2^n}nl_{r-2}D_b(D_af)},\]
    into the summation  of right-hand side,
    \[nl_r(f) \ge 2^{n-1}-\frac{1}{2}\sqrt{2^{2n}-2\sum_{a\in\F_2^n}nl_{r-1}(D_af)},\]
    we obtain the relation between the third-order nonlinearity of $f$ and the nonlinearities of the second-order derivatives of $f$:
    \begin{equation}\label{eq:nl3_nlDaDbf}
        nl_3(f)\ge 2^{n-1}-\frac{1}{2}\sqrt{\sum_{\alpha\in\F_{2^n}}\sqrt{2^{2n}-2\sum_{\beta\in\F_{2^n}} nl(D_{\beta}D_{\alpha}f)}}.
    \end{equation}
    Therefore, we can give a lower bound on the third-order nonlinearity of the simplest $\mathcal{PS}_{ap}$ bent function, which can be directly deduced from Inequality \eqref{eq:nl3_nlDaDbf} with Theorem \ref{thm:nl_DaDbf}:
    \begin{theorem}\label{th:our_lower_bound}
        Let $k\ge 3$ be an integer and $n=2k$. For the third-order nonlinearity of the simplest $\mathcal{PS}_{ap}$ bent function $f(x,y)=\TRACE(\frac{\lambda x}{y})$ with $x,y\in\F_{2^k}$ and $\lambda\in\F_{2^k}^*$, we have:
        \[nl_3(f)\ge 2^{n-1}-\frac{1}{2}\sqrt{A},\]
        % \approx 2^{n-1}-2^{\frac{7n}{8}+\frac{1}{2}}.
        where
        \begin{align*}
            A=2^n+&(2^{\frac{n}{2}}-1)\sqrt{(2^{\frac{3n}{2}+1}-2^{n+1})\left\lfloor 2^{\frac{n}{4}+1}\right\rfloor+5\cdot 2^{\frac{3n}{2}}-2^{n+2}}\\
            +&(2^n-2^{\frac{n}{2}})\sqrt{2^{\frac{3n}{2}+2}-15\cdot 2^n-2^{\frac{n}{2}+2}+(2^{n+2}-2^{\frac{n}{2}+1})\left\lfloor 2^{\frac{n}{4}+1}\right\rfloor+2^{n+2}L},
        \end{align*}
        and $L$ is defined in Lemma \ref{L:SumInv00}.
    \end{theorem}
    \begin{proof}
        We have
        \begin{align*}
            nl_3(f)&\ge 2^{n-1}-\frac{1}{2}\sqrt{\sum_{\alpha\in\F_{2^n}}\sqrt{2^{2n}-2\sum_{\beta\in\F_{2^n}} nl(D_{\beta}D_{\alpha}f)}}\\
            &=2^{n-1}-\frac{1}{2}\sqrt{\left( \sum_{\alpha=(0,0)}+\sum_{\alpha=(\alpha_1,0)\in\F_{2^k}^*\times\{0\}}+\sum_{\substack{\alpha=(\alpha_1,\alpha_2)\in\F_{2^k}\times\F_{2^k}^*}} \right)\sqrt{2^{2n}-2\sum_{\beta\in\F_{2^n}} nl(D_{\beta}D_{\alpha}f)}}\\
            &\ge 2^{n-1}-\frac{1}{2}\left[2^n+(2^{\frac{n}{2}}-1)\sqrt{2^{2n}-2(2^n-2^{\frac{n}{2}})(2^{n-1}-2^{\frac{n}{2}}\left\lfloor 2^{\frac{n}{4}+1}\right\rfloor-2^{\frac{n}{2}+1})}\right.\\
            &\qquad\qquad\qquad\left.+(2^n-2^{\frac{n}{2}})\sqrt{2^{2n}-2\left( (2^{n-1}-2^{\frac{n}{2}+1})(2^n-1)-(2^{n+1}-2^{\frac{n}{2}})\left\lfloor 2^{\frac{n}{4}+1}\right\rfloor+2^{n+3}-2^{n+1}L \right)}\right]^{\frac{1}{2}},
        \end{align*}
        where the second sign of inequality comes from Lemma \ref{thm:nl_DaDbf}.
        Then, we have
        \begin{align*}
            A=2^n+&(2^{\frac{n}{2}}-1)\sqrt{(2^{\frac{3n}{2}+1}-2^{n+1})\left\lfloor 2^{\frac{n}{4}+1}\right\rfloor+5\cdot 2^{\frac{3n}{2}}-2^{n+2}}\\
            +&(2^n-2^{\frac{n}{2}})\sqrt{2^{\frac{3n}{2}+2}-15\cdot 2^n-2^{\frac{n}{2}+2}+(2^{n+2}-2^{\frac{n}{2}+1})\left\lfloor 2^{\frac{n}{4}+1}\right\rfloor+2^{n+2}L}.
        \end{align*}
        This completes the proof.
    \end{proof}
    \begin{corollary}
        The third-order nonlinearity of the simplest $\mathcal{PS}_{ap}$ bent function in $n$ variables is lower bounded by approximately $2^{n-1}-2^{\frac{7n}{8}-\frac{1}{2}}$.
    \end{corollary}
    \begin{remark}
        \newcommand{\rb}[1]{\raisebox{1.5ex}[0pt]{#1}}
        We only compare in Table \ref{table:MyTableLabel} our lower bound on the third-order nonlinearity of the simplest $\mathcal{PS}_{ap}$ bent function with two previously known bounds for some small concrete values.
        It can be seen that our lower bound on the third-order nonlinearity is always tighter than lower bounds in \cite{TangCT2013NL_2bent,Carlet2011NL_Profile_Dillon}.
        And when $n$ is not too large, our lower bound is much more efficient than others.
        \begin{table}
            \centering
            \caption{Comparison of lower bounds on the third-order nonlinearity of the simplest $\mathcal{PS}_{ap}$ bent functions}
            \begin{threeparttable}
                \begin{tabular}{|c|c|c|c|c|}
                    \hline
                            & Tang-Carlet-Tang bound      & Carlet bound                            & Our bound& \\
                    \rb{$n$}& in \cite{TangCT2013NL_2bent}& in \cite{Carlet2011NL_Profile_Dillon} & in Theorem \ref{th:our_lower_bound}     &\rb{Difference\tnote{1}}   \\
                    \hline
                    $6  $ &  $ -           $       & $ -        $     & $ 1        $     & $  -       $ \\  \hline
                    $8  $ &  $ -           $       & $ -        $     & $ 26       $     & $  -       $ \\  \hline
                    $10 $ &  $ 55          $       & $ 63       $     & $ 186      $     & $  123     $ \\  \hline
                    $12 $ &  $ 533         $       & $ 553      $     & $ 932      $     & $  379     $ \\  \hline
                    $14 $ &  $ 3156        $       & $ 3205     $     & $ 4372     $     & $  1167    $ \\  \hline
                    $16 $ &  $ 15985       $       & $ 16103    $     & $ 19986    $     & $  3883    $ \\  \hline
                    $18 $ &  $ 75003       $       & $ 75292    $     & $ 89028    $     & $  13736   $ \\  \hline
                    $20 $ &  $ 336634      $       & $ 337330   $     & $ 384926   $     & $  47596   $ \\  \hline
                    $22 $ &  $ 1468219     $       & $ 1469893  $     & $ 1628771  $     & $  158878  $ \\  \hline
                    $24 $ &  $ 6278535     $       & $ 6282551  $     & $ 6807315  $     & $  524764  $ \\  \hline
                    $26 $ &  $ 26469867    $       & $ 26479472 $     & $ 28238083 $     & $  1758611 $ \\  \hline
                \end{tabular}
                \begin{tablenotes}
                    \footnotesize
                    \item[$\star$] All concrete values of lower bounds in this table are approximated to nearest  integers greater than or equal to values. 
                    \item[1] The values in the table are the difference of our bound's values with  Carlet bound's values.
                \end{tablenotes}
            \end{threeparttable}
            \label{table:MyTableLabel}
        \end{table}
    \end{remark}

    \begin{remark}
        We almost determine the nonlinearities of all second-order derivatives of the simplest $\mathcal{PS}_{ap}$ bent function, except the trivial cases, where only a lower bound on the nonlinearities can be derived. 
        Fortunately, compared with the number of nontrivial cases, the number of the trivial cases is negligible, 
        which suggests that our lower bound is tighter than others, since other lower bounds even use the imprecise nonlinearities of all second-order derivatives of the function deduced from some inequalities. 
        Especially, the smaller the number of variables is, the more efficient our lower bound compares with other lower bounds. 
    \end{remark}
\section{Conclusion}
    As the higher order nonlinearity of Boolean functions measures the ability of cryptosystems in which they are involved to resist some attacks such as approximation attacks, correlation attacks and so on, Boolean functions used in cryptosystems should satisfy this cryptographic criteria.
    In the paper we derive a lower bound on the third-order nonlinearity of the simplest $\mathcal{PS}_{ap}$ bent function.
    Our lower bound improves previously known lower bounds in earlier works \cite{TangCT2013NL_2bent,Carlet2011NL_Profile_Dillon}.
    We hope that the result obtained will play an important role with respect to countermeasures against those known attacks. 

\bibliographystyle{plain}
\bibliography{mybib}

\end{document}



% for i in [1..2^5] do
%     inputvector:=Intseq(i-1,2,n);
%     eltvector:=&+[inputvector[j]*v^(j-1):j in [1..n]];
%     Append(~input,(eltvector));
% end for;

% for i in [1..2^n] do
%     inputvector:=Intseq(sbox[i],2,n);
%     eltvector:=&+[inputvector[j]*v^(j-1):j in [1..n]];
%     Append(~output,(eltvector));
% end for;

% function newsbox(x)
%     if x eq 0 then
%         return 0;
%     end if;
%     for i in [1..1024] do
%         if x eq input[i] then
%             return output[i];
%         end if;
%     end for;
% end function;



% G:=OrthoTest(newsbox,n);
% ddtG:=DDTexe(G,n);



%   \begin{tikzpicture}[
%     node distance = 5ex,
%     scale = 3,
%     thick,
%     > = latex,
%     % change the
%     z = {(0.35, -0.4)},
%     edge/.style = {draw, thick, -, black},
%     sinal/.style = {inner sep = 1pt, thin, opacity = 0.4,
%       fill = blue, circle, text opacity = 1},
%     mtx/.style = {
%   %     matrix of math nodes,
%       matrix of nodes,
%       every node/.style = {
%         anchor = base,
%         text width = 2em,
%         text height = 1em,
%         align = center,
%       }
%     },
%     ]

%     \def\dist{0.1}
%     \def\cube{
%         % Vertices. (A,B,C), A x  B z  C y


%         % \node[left] (v0) at (0,0,0) {$ A $};
%         % note that command above can construct nodes and label them at the same time,
%         % but sometimes you don't need the text,
%         % so I just construct the coordinates and then label coordinates
%         \coordinate (v0) at (0, 0, 0)  ;
%         \coordinate (v1) at (0, 1, 0)  ;
%         \coordinate (v2) at (1, 0, 0)  ;
%         \coordinate (v3) at (1, 1, 0)  ;
%         \coordinate (v4) at (0, 0, 1)  ;
%         \coordinate (v5) at (0, 1, 1)  ;
%         \coordinate (v6) at (1, 0, 1)  ;
%         \coordinate (v7) at (1, 1, 1)  ;
%         \coordinate (v8) at (0, 2, 0)  ;
%         \coordinate (v9) at (1, 2, 0)  ;
%         \coordinate (v10) at (0, 2, 1) ;
%         \coordinate (v11) at (1, 2, 1) ;
%     }
%     \begin{scope}[opacity=1] % opacity is the transparent
%         \cube{};
%         % labeling verticals with text A B C at left\right\below\above\below left\below right\above left\above right
%         \node[left] at (v0) {$ A $};
%         \node[left] at (v1) {$ B $};
%         \node[right] at (v2) {$ C $};
%         \node[above right] at (v3) {$ D $};
%         \node[left] at (v4) {$ E $};
%         \node[below left] at (v5) {$ F $};
%         \node[right] at (v6) {$ G $};
%         \node[right] at (v7) {$ H $};
%         \node[left] at (v8) {$ I $};
%         \node[above right] at (v9) {$ J $};
%         \node[below left] at (v10) {$ K $};
%         \node[right] at (v11) {$ L $};
%         % Edges with some differential: alpha gamma beta theta
%         % arrow with direction from v1 to v0

%         \draw[->] (v2) -- (v3);
%         \draw[->] (v3) -- (v9);
%         \draw[->] (v6) -- (v7);
%         \draw[->] (v7) -- (v11);
%         % dotted line from v1 to v2 and the middle of line labeled is gamma
%         \draw[dashed] (v0) -- node[fill = white] {$ \gamma $} (v2) ;
%         \draw[dashed] (v4) -- node[fill = white] {$ \gamma $} (v6);
%         \draw[dashed] (v1) -- node[fill = white] {$ \beta $} (v5) -- node[fill = white] {$ \theta $} (v7) -- node[fill = white] {$ \beta $}(v3) -- node[fill = white] {$ \theta $} (v1);
%         \draw[dashed] (v8) -- node[fill = white] {$ \alpha $}(v10);
%         \draw[dashed] (v11) -- node[fill = white] {$ \alpha $}(v9);
%     \end{scope}

%     \begin{scope}[opacity=0.2]
%         % the pics in this part are transparent 0.2,
%         % if not want this condition, delete the commands.
%         \draw[<-] (v0) -- (v1);
%         \draw[<-] (v1) -- (v8);
%         \draw[<-] (v4) -- (v5);
%         \draw[<-] (v5) -- (v10);
%     \end{scope}

%         % \foreach \i in {0, 1, ..., 11}{ \draw[fill = black] (v\i) circle (0.1pt); }
%         % } % boomerang attack model

%         \begin{scope}[]
%             %
%             \coordinate (E0)  at (2, 0-0.4, 0);
%             \coordinate (E0L) at (2-0.3, 0-0.4, 0);
%             \coordinate (E0R) at (2+0.15, 0-0.4, 0);
%             \coordinate (E1)  at (2, 1-0.4, 0);
%             \coordinate (E1L) at (2-0.3, 1-0.4, 0);
%             \coordinate (E1R) at (2+0.15, 1-0.4, 0);
%             \coordinate (E2)  at (2, 2-0.4, 0);
%             \coordinate (E2L) at (2-0.3, 2-0.4, 0);
%             \coordinate (E2R) at (2+0.15, 2-0.4, 0);
%             \draw[->] (E0) -- node[right] {$ E_1^{-1} $} (E1);
%             \draw[->] (E2) -- node[right] {$ E_0 $} (E1);
%             % dotted line with transparent
%             \draw[dashed,opacity=.5] (E0R) -- (E0) -- (E0L);
%             \draw[dashed,opacity=.5] (E1R) -- (E1) -- (E1L);
%             \draw[dashed,opacity=.5] (E2R) -- (E2) -- (E2L);
%         % \foreach \i in {0, 1, ..., 11}{
%         %   \node at (v\i) {\i};
%         % }
%       \end{scope}

%     \end{tikzpicture}%

F<v>:=GF(2,8);
G:=[x:x in F|x^8 + x^4 + x^3 + x^2 + 1 eq 0];
for g in G do
    g:=v;
    // sbox=[0, 152, 136, 56, 65, 217, 149, 189, 142, 95, 147, 214, 10, 103, 171, 213, 185, 4, 3, 20, 93, 54, 199, 202, 198, 116, 227, 33, 124, 181, 56, 196, 106, 5, 53, 40, 169, 194, 117, 56, 58, 122, 82, 103, 60, 9, 178, 182, 111, 194, 132, 67, 83, 248, 191, 27, 228, 122, 186, 157, 232, 61, 96, 24, 26, 6, 145, 122, 45, 76, 121, 25, 204, 64, 58, 52, 142, 177, 11, 37, 254, 244, 188, 143, 2, 206, 39, 59, 105, 140, 48, 101, 28, 161, 241, 228, 182, 193, 124, 211, 65, 13, 0, 116, 55, 254, 4, 9, 218, 12, 100, 24, 233, 116, 140, 54, 224, 53, 158, 51, 153, 73, 222, 88, 22, 68, 45, 182, 165, 33, 134, 12, 150, 118, 162, 210, 49, 123, 233, 9, 154, 56, 207, 176, 203, 54, 164, 210, 218, 159, 66, 222, 89, 139, 220, 22, 143, 187, 37, 83, 142, 112, 152, 202, 179, 251, 33, 15, 114, 126, 132, 163, 158, 222, 216, 110, 245, 153, 76, 173, 197, 226, 232, 254, 45, 109, 110, 55, 247, 95, 56, 107, 7, 102, 152, 14, 29, 231, 100, 169, 255, 145, 63, 22, 236, 121, 200, 154, 38, 237, 17, 76, 223, 46, 7, 92, 60, 6, 110, 38, 222, 149, 45, 69, 32, 242, 189, 200, 151, 193, 38, 176, 195, 88, 100, 204, 28, 232, 181, 193, 66, 146, 67, 137, 8, 86, 47, 216, 111, 218, 174, 6, 172, 113, 104, 103 ];

    nonlinearity v:=v^24
    f:=func<x|x^3 + g^60*x^5 + g^191*x^6 + g^198*x^9 + g^232*x^10 + g^120*x^12+ g^54*x^17 + g^64*x^18 + g^159*x^20 + g^144*x^24 + g^248*x^33+ g^203*x^34 + g^32*x^36 + g^18*x^40 + g^216*x^48 + g^78*x^65+g^46*x^66 + g^91*x^68 + g^27*x^72 + g^70*x^80 + g^52*x^96+ g^224*x^129 + g^18*x^130 + g^197*x^136 + g^253*x^144 + x^160>;
    for b in F do
        if b eq 0 then continue; end if;
        Walsh_spectra:=[];
        for a in F do
            Append(~Walsh_spectra,Abs(&+[(-1)^(Integers()!Trace(b*f(x)+a*x)):x in F]));
        end for;
        Set(Walsh_spectra);
        //if Max(Walsh_spectra) eq 128 then
        //    print "b=",b;
        //end if;
    end for;
end for;

F<v>:=GF(2,8);
g:=v;
for i in [10..255] do
    i:=24;
    f:=func<x|Trace(v^i*(x^3 + g^60*x^5 + g^191*x^6 + g^198*x^9 + g^232*x^10 + g^120*x^12+ g^54*x^17 + g^64*x^18 + g^159*x^20 + g^144*x^24 + g^248*x^33+ g^203*x^34 + g^32*x^36 + g^18*x^40 + g^216*x^48 + g^78*x^65+g^46*x^66 + g^91*x^68 + g^27*x^72 + g^70*x^80 + g^52*x^96+ g^224*x^129 + g^18*x^130 + g^197*x^136 + g^253*x^144 + x^160))>;
    if Max([&+[(-1)^(Integers()!(f(x)+Trace(a*x))):x in F]:a in F]) eq 128 then
    wf:=[&+[(-1)^(Integers()!(f(x)+Trace(a*x))):x in F]:a in F];
    i;
    end if;
end for;

subspace_set:={};
for a,b in GF(2,4) do
    if a eq b then continue; end if;
    flag:=0;
    for x in F do
        if f(x)+f(x+a)+f(x+b)+f(x+a+b) ne 0 then
            flag:=1;
            break;
        end if;
    end for;
    if flag eq 1 then
        print "not a subspace";
        break;
    end if;
end for;




% for g=v, we have b=v^24 s.t. bf is an affine function.
======================================================================================

diff_spec:=[
    [ 0, 2, 6, 595386, 416361, 35805 ],
    [ 0, 2, 4, 6, 8, 12, 713031, 211761, 92070, 15345, 5115, 10230 ],
    [ 0, 2, 4, 6, 8, 629331, 330336, 72540, 13020, 2325 ],
    [ 0, 2, 4, 6, 8, 628401, 329871, 75330, 12555, 1395 ],
    [ 0, 2, 4, 6, 8, 10, 633636, 322701, 75045, 13980, 1905, 285 ],
    [ 0, 2, 4, 6, 8, 10, 12, 630216, 327081, 76215, 12150, 1665, 195, 30 ],
    [ 0, 2, 4, 6, 8, 10, 635314, 317626, 80290, 11780, 2480, 62 ],
    [ 0, 2, 4, 6, 8, 10, 631811, 322617, 80197, 11098, 1674, 155 ],
    [ 0, 2, 4, 6, 8, 10, 633733, 320695, 78399, 12803, 1736, 186 ],
    [ 0, 2, 4, 6, 8, 10, 641514, 307706, 81375, 14880, 1705, 372 ],
    [ 0, 2, 4, 6, 8, 10, 634260, 321036, 76353, 13857, 1767, 279 ],
    [ 0, 2, 4, 6, 8, 10, 12, 14, 630664, 324942, 78647, 11842, 1364, 31, 31, 31 ],
    [ 0, 2, 4, 6, 8, 22, 636306, 315018, 82335, 11715, 2145, 33 ],
    [ 0, 2, 4, 6, 8, 637701, 313131, 80910, 14415, 1395 ],
    [ 0, 2, 4, 6, 8, 626541, 330336, 79515, 10230, 930 ],
    [ 0, 2, 4, 6, 8, 10, 634291, 318401, 81995, 10385, 2170, 310 ],
    [ 0, 2, 4, 6, 8, 640491, 304296, 89280, 13020, 465 ],
    [ 0, 2, 4, 6, 8, 10, 12, 632431, 322958, 77562, 13020, 1333, 186, 62 ],
    [ 0, 2, 4, 6, 8, 624216, 334986, 76725, 11160, 465 ],
    [ 0, 2, 4, 6, 8, 10, 639045, 311861, 80410, 13860, 2365, 11 ]
];

=====================================================================================
// we want to find 10 bit quadratic APN, and test whether they are ccz-eq to some APN classes or instances
// f(x)=x^d+x^i+beta*x^j is a trinomial, it ccz eq to x^d +alpha*x^i+beta*x^j, so we confirm that no new APN instance for trinomial.
// d = 5,6,9,10,12,17,33,34,40,48,65,66,68,72,80,96,129,130,132,136,144,160,192,257,258,260,264, 272, 288, 320, 384, 513, 514, 516, 520, 528, 544, 576, 640, 768 no APN instance

// test x^d + x^i + beta x^j, exclude the case of EA s.t. L2 . F . L1
n:=10;
Z:=Integers();
F<v>:=GF(2,n);
F5<w>:=GF(2,n div 2);
Fstar:=[v^i:i in [0..2^n-2]];
P<x>:=PolynomialRing(F);
index_wt_2:={2^i+2^j:i,j in [0..n-1]|i ne j};

load "DiffSpecOdExe.m";
for d in D do
    for i,j in index_wt_2 do
        if i eq d or j eq d or i eq j then continue; end if;
        //exclude the case of L2=a x^2i + b x^2j + x and F = x^3
        if i in {2^k*3:k in [0..n-1]} and j in {2^k*3:k in [0..n-1]} then continue; end if;
        if i in {2^k*3^2:k in [0..n-1]} and j in {2^k*3^2:k in [0..n-1]} then continue; end if;
        ccz_coef_set:={};
        i,j;
        for beta in Fstar do
            if #{x^(2^i):x in ccz_coef_set,i in [1..n-1]} eq 2^n-1 then break; end if;
            // exclude the case of L2=2^{n-i},L1=2^i
            if beta in {x^(2^i):x in ccz_coef_set,i in [1..n-1]} then continue; end if;
            f:=x^d+x^i+beta*x^j;
            if IsAPN(f) eq true then
                print "f is APN and parameters [i,j,beta] are:";
                i,j,beta;
                ddtS:=DiffSpecOd(func<x|x^d+x^i+beta*x^j>,n);
                ddtS;
                if ddtS notin diff_spec then
                    print "new diff_spec_od,i=",i;
                    Write("APN_10bit_new_instance.txt",[i,j]);
                    Write("APN_10bit_new_instance.txt",beta);
                else
                    print "existing instance!";
                    // exclude the case of L2=a^d x,L1=x/a
                    Include(~ccz_coef_set,beta);
                end if;
            else
                //print "not APN";
                Include(~ccz_coef_set,beta);
            end if;
        end for;
    end for;
end for;


//another f(x) is a quadrinomial, f = x^9 + a*Tr_2^n(b*x^i)

n:=10;
d:=9;
Z:=Integers();
F<v>:=GF(2,n);
Fstar:=[v^i:i in [0..2^n-2]];
P<x>:=PolynomialRing(F);
index_wt_2:={2^i+2^j:i,j in [0..n-1]|i ne j};

for i in index_wt_2 do
    if i in [2^j*d:j in [0..n-1]] then continue; end if;
    i;
    ccz_coef_set:={};
    for beta in Fstar do
        if #{x^(2^i):x in ccz_coef_set,i in [1..n-1]} eq 2^n-1 then break; end if;
        // exclude the case of L2=2^{n-i},L1=2^i
        if beta in {x^(2^i):x in ccz_coef_set,i in [1..n-1]} then continue; end if;
        f:=func<x|x^d+ v^2*(&+[(beta*x^i)^((2^2)^(j-1)):j in [1..n div 2]])>;
        if IsAPN(f,n) eq true then
            print "f is APN and parameters [i,j,beta] are:";
            i,beta;
            ddtS:=DiffSpecOd(f,n);
            ddtS;
            if ddtS notin diff_spec then
                print "new diff_spec_od,i=",i,"beta=",beta;
                Write("APN_10bit_new_instance.txt",i);
                Write("APN_10bit_new_instance.txt",beta);
            else
                print "existing instance!";
                // exclude the case of L2=a^d x,L1=x/a
                Include(~ccz_coef_set,beta);
            end if;
        else
            //print "not APN";
            Include(~ccz_coef_set,beta);
        end if;
    end for;
end for;



=====================================================================================



function Sbox2ff(inputsbox)
    Z:=Integers();
    n:=Ilog2(#inputsbox);
    F<v>:=GF(2,n);
    list:=[];
    for i in [0..2^n-2] do
        Append(~list,&+[Intseq(inputsbox[&+[Z!Eltseq(v^i)[j]*2^(j-1):j in [1..n]]+1],2,n)[k]*v^(k-1):k in [1..n]]);
    end for;
    Append(~list,F!0);
    function ff_fromsbox(x)
        return (x eq 0) select F!0 else list[Log(x)+1];
    end function;
    return ff_fromsbox;
end function;


======================================================================================

function IsAPN(f,variables)
    n:=variables;
    F<al>:=GF(2,n);
    for i in [0..2^n-2] do
        a:=al^i;
        set_b:={}; set_a:={};
        for y in F do
            if not y in set_a then
                b:=f(y+a)-f(y);
                if b notin set_b then
                    Include(~set_b,b);
                else
                    return false;
                end if;
                Include(~set_a,y+a);
            end if;
        end for;
    end for;
    return true;
end function;


function IsAPN(f)
    P:=Parent(f);
    F<al>:=BaseRing(P);
    n:=Degree(F);
    for i in [0..2^n-2] do
    a:=al^i;
    set_b:={}; set_a:={};
    for y in F do if not y in set_a then
    b:=Evaluate(f,y+a)-Evaluate(f,y);
    if b notin set_b then Include(~set_b,b);
    else
    return false; end if;
    Include(~set_a,y+a); end if;
    end for; end for;
    return true;
end function;


Z:=Integers();
F<v>:=GF(2,8);
[&+[Z!Eltseq(x)[i]*2^(i-1):i in [1..8]]:x in F]; 